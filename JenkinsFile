pipeline {
    agent any
    stages {
        stage('code-pulling') {
            steps {
                git branch: 'main', credentialsId: 'mohitjen', url: 'https://github.com/abhay9175/student-ui.git'
            }
        }
        stage('build-maven') {
            steps {
                sh 'sudo apt update -y'
                sh 'sudo apt install maven -y'
                sh 'mvn clean package' 
            }
        }
        stage('artifact to nexus') {
            steps {
                script{
                    def mavenPom = readMavenPom file: 'pom.xml'
                nexusArtifactUploader artifacts: [
                   [
                       artifactId: 'studentapp', 
                       classifier: '', 
                       file: 'target/studentapp-2.2.war', 
                       type: 'war'
                    ]
                ], 
                credentialsId: 'nexuscred',
                groupId: 'com.jdevs', 
                nexusUrl: '172.31.27.56:8081',
                nexusVersion: 'nexus2', 
                protocol: 'http',
                repository: 'http://52.87.167.183:8081/repository/studentapp-release/', 
                version: '2.2'
               }        
          
            }
        }
    }    
}
